<!--
    TODO: 
        Finish up interactions with vote controller.
        Do something about, when vote is made, then model picks two more votable items.
        Consider getting rid of BackendClient.js if redundant?
        Fix inline-block css with vote-items.
        Fix up css.
        Handle errors in controllers.
        
        
        
        
        Blurb - i think we may need to reverse escape some of the e.g. blurb data somewhere?
            May be json encoding, or mysql?
        
        Vote section:
            Fit blurb into card.
            Make cards look good.
        
        Scoreboard section:
            Keep the sizing and formatting of the table fixed so the < & > buttons don't move around.
            
-->
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="scripts/include.js"></script>
<style>
#body {
    /* Stop the main body of the site from resizing stupidly when the browser has low width. */
    min-width: 700px;
}

.section {
    padding-top: 10px;
    padding-bottom: 10px;
    margin-top: 40px;
    margin-bottom: 40px;
    
    border: 3px solid purple;
}

.vote-item {
    position: relative;
    
    /* http://www.w3schools.com/css/css_inline-block.asp */
    display: inline-block;
    vertical-align: middle;
    
    width: 45%;
    margin: 1%;
    padding: 1% 1% 1% 1%;
    height: 400px;
    
    border: 3px solid blue;
}

.vote-item-img {
    width: 128px;
    height: 128px;
    
    /* Centre image */
    display:block;
    margin:auto;
}

.vote-item-button {
    /* 
        Required to make the vote button stay at the bottom of the containing div.
        Also requires the parent div to have position: relative;
        
        Consider using a table to achieve the same effect?
    */
    position: absolute;
    bottom: 0;
    
    /* Give the button some space at the bottom. */
    padding-bottom: 2%;
    
    /* Centre the button horizontally. */
    left: 50%;
}

h3.scoreTitle {
    text-align: center;
}

table.entityTable {
    width: 100%;
    /* Remove the spaces between horizontally adjacent cells. */
    border-collapse: collapse;
}

td.entityTable {
    text-align: center;
}

tr.entityTable:nth-child(even) {
    background-color: lightblue;
}

/* The following two are to spread out the buttons evenly horizontally. */
div.scoreButtons {
    display: table;
    width: 100%;
    table-layout: fixed;    /* For cells of equal size */
}

div.scoreButtons span {
    display: table-cell;
    text-align: center;
}

h3.searchTitle {
    text-align: center;
}

.searchForm {
    margin-left: 10px;
    margin-bottom: 20px;
}

#header {
    padding-top: 20px;
    padding-bottom: 20px;
    margin-top: 20px;
    margin-bottom: 20px;
    
    border: 3px solid red;
}

#attributions {
    margin-top: 20px;
    margin-bottom:20px;
    padding: 1% 1% 1% 1%;
    height: 300px;
    
    border: 3px solid green;
}

#links {
    margin-top: 20px;
    margin-bottom:20px;
    margin-left: 40%;
    margin-right: 40%;
    padding: 1% 1% 1% 1%;
    height: 300px;
    
    text-align: center;
    
    border: 3px solid green;
}

#footer {
    padding-top: 20px;
    padding-bottom: 20px;
    margin-top: 50px;
    
    position: fixed;
    bottom: 0;
    left: 0;
    
    border: 3px solid yellow;
}
</style>
</head>
<body ng-app="poco">
    
    <div id="header">Header</div>
    
    <div id="body">
        
        <!-- Voting section -->
        <div ng-controller="vote" class="section">
            <div ng-repeat="e in votableEntities" class="vote-item">
                <!-- Card layout: -->
                
                <!-- <p>{{ e.id }}</p> -->
                
                <p>{{ e.category }}</p>
                
                <p>{{ e.name }}</p>
                
                <img class="vote-item-img" ng-src="{{ e.image_url || 'img/content/alt_entity_image.png' }}" alt="{{ e.name }}"/>
                
                <div>{{ e.blurb }}</div>
                
                <p>{{ e.score }}</p>
                
                <div class="vote-item-button">
                    <button type="button" ng-click="onVoteUp(e.id)">Vote</button>
                </div>
            </div>
        </div>
        
        <!-- Scoreboard section -->
        <div ng-controller="scoreboard" class="section">
            <h3 class="scoreTitle">Rankings</h3>
            <table class="entityTable">
                <tr class="entityTable">
                    <th class="entityTable">Rank</th>
                    <th class="entityTable">Category</th>
                    <th class="entityTable">Name</th> 
                    <th class="entityTable">Score</th>
                </tr>
                <tr ng-repeat="i in items" class="entityTable">
                    <td class="entityTable">{{ i.rank }}</td>
                    <td class="entityTable">{{ i.category }}</td>
                    <td class="entityTable">{{ i.name }}</td>
                    <td class="entityTable">{{ i.score }}</td>
                </tr>
            </table>
            <div class="scoreButtons">
                <span><button type="button" ng-click="onMoveUp()">&lt;</button></span>
                <span><button type="button" ng-click="onMoveDown()">&gt;</button></span>
            </div>            
        </div>
        
        
        
        <!-- Search section -->
        <div ng-controller="search" class="section">
            <div>
                <h3 class="searchTitle">Search</h3>
                <!-- 
                    Search controls
                    See http://www.w3schools.com/angular/angular_forms.asp
                -->
                <form novalidate class="searchForm">
                    <input type="text" ng-model="fragment"><br>
                    <button ng-click="runQuery()">Search</button>
                </form>
                
                <table class="entityTable">
                    <tr class="entityTable">
                        <th class="entityTable">Category</th>
                        <th class="entityTable">Name</th> 
                        <th class="entityTable">Score</th>
                    </tr>
                    <tr ng-repeat="i in items" class="entityTable">
                        <td class="entityTable">{{ i.category }}</td>
                        <td class="entityTable">{{ i.name }}</td>
                        <td class="entityTable">{{ i.score }}</td>
                    </tr>
                </table>
                
            </div>
        </div>
        
        
        
        
        
        <div id="links">Links</div>
        
        <div id="attributions">Attributions</div>
    </div>
    
    <div id="footer">Footer</div>
    
</body>
</html>